<!doctype html>
<html lang="zh-cn">
<head>
<meta charset="utf-8" />
<title>翻页模板 - QQ音乐</title>
<meta name="format-detection" content="telephone=no" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
<link rel="stylesheet" href="style/index.css" />
</head>
<body>
<div id="wrap"><div id="loading"><div></div></div></div>

<div class="wrap">
    <div class="item item-0">
        <div class="box" style="background:#cc0c39; ">
            <h2>页面一</h2>
        </div>
        <!--可自定义背景图-->
        <div class="bg"></div>
    </div>

    <div class="item item-1">
        <div class="box" style="background:#ed9761; ">
            <h2>页面二</h2>
        </div>
        <!--可自定义背景图-->
        <div class="bg"></div>
    </div>

    <div class="item item-2">
        <div class="box" style="background:#ff5757; ">
            <h2>页面三</h2>
        </div>
        <!--可自定义背景图-->
        <div class="bg"></div>
    </div>

    <div class="item item-3">
        <div class="box" style="background:#851941; ">
            <h2>页面四</h2>
        </div>
        <!--可自定义背景图-->
        <div class="bg"></div>
    </div>

    <div class="item item-4">
        <div class="box" style="background:#1693a7; ">
            <h2>页面五</h2>
        </div>
        <!--可自定义背景图-->
        <div class="bg"></div>
    </div>
</div>


<!--控制  包括翻页点样式 分享图标音乐图标-->
<div class="mod_control firstScr" style="display:;">
    <ul class="mod_tag" id="mod-tag-page">
        <li class="current"><span>1</span></li>
        <li><span>2</span></li>
        <li><span>3</span></li>
        <li><span>4</span></li>
        <li><span>5</span></li>
        <li><span>6</span></li>
        <li><span>7</span></li>
        <li><span>8</span></li>
        <li><span>9</span></li>
    </ul>
    <a href="javascript:;" class="btn_favorite" id="btn_favorite"><i></i></a>
    <div class="mod_start"><i></i></div>
    <a class="btn_share" href="javascript:;">分享活动</a>

</div>


<!--播放控制-->
<a href="#" class="audio_btn icon_sound_on" id="btn_audio" style="display:none"></a>
<!--将icon_sound_on 样式名改为 icon_sound_off 即可设置成静音 -->

<div id="share_btn_tip" class="mod_share" style="bottom:14px;right:10px;display:none">点击这里分享<i id="arrow_top" style="display:none" class="top"></i><i style="display:none" id="arrow_bottom" class="bottom"></i></div>

<!--页面调用JS库-Zepto  -->
<script src="http://imgcache.gtimg.cn/music/yanchu/mact/lib/zepto.min.js?max_age=86400000"></script>
<script type="text/javascript">
(function ($) {

    //主事件处理代码
    function addEvtHandler() {

        var swipeTouched = false;
        var swipeMoving = false;
        var swipeCurEl = null;
        var swipeSiblingEl;
        var swipeY1;
        var swipeWinH;
        var swipeDeltaY;
        var swipeIsUp;
        $(document).on('touchstart', function (evt) {
            if (evt.touches.length > 1 || swipeMoving || swipeTouched ) {
                return;
            }

            swipeCurEl = $(evt.target);

            if (!swipeCurEl.is('.item')) {
                swipeCurEl = swipeCurEl.parents('.item');
            }

            swipeTouched = true;
            swipeY1 = evt.touches[0].pageY;
            swipeWinH = $(window).height();
        }).on('touchmove', function (evt) {
            if (evt.touches.length > 1 || !swipeTouched) {
                //swipeTouched = false;
                return;
            }
            swipeDeltaY = evt.touches[0].pageY - swipeY1;
            swipeIsUp = swipeDeltaY < 0 ? true : false;

            swipeSiblingEl = swipeIsUp ? swipeCurEl.next('.item') : swipeCurEl.prev('.item');

            if (swipeSiblingEl.size() == 0) {
                swipeTouched = false;
                return;
            }

            swipeMoving = true;

            swipeCurEl.css({
                '-webkit-transition' : 'none',
                '-webkit-transform-origin' : swipeIsUp ? '50% 0%' : '50% 100%',
                '-webkit-transform' : 'scale(' + (1 - Math.abs(swipeDeltaY / swipeWinH)) + ')'
            });

            swipeSiblingEl.css({
                '-webkit-transition' : 'none',
                '-webkit-transform' : 'translate(0, ' + (swipeDeltaY + (swipeIsUp ? swipeWinH : -swipeWinH)) + 'px)'
            });


        }).on('touchend', function () {
            if ( !swipeMoving || !swipeTouched) {
                return;
            }

            swipeCurEl.css({
                '-webkit-transition' : '-webkit-transform 0.4s ease-out',
                '-webkit-transform-origin' : swipeIsUp ? '50% 0%' : '50% 100%',
                '-webkit-transform' : 'scale(0)'
            }).one('webkitTransitionEnd', function () {

                $(this).css({
                    '-webkit-transform' : 'translate(0, ' + (swipeIsUp ? '-' : '') + '100%) scale(1)'
                });
                swipeMoving = false;
                swipeCurEl = null;
                swipeSiblingEl = null;
            });
            swipeSiblingEl.css({
                '-webkit-transition' : '-webkit-transform 0.4s ease-out',
                '-webkit-transform' : 'translate(0, 0)'
            }).one('webkitTransitionEnd', function () {
                $(".item").removeClass("play");
                var el = $(this);
                el.addClass("play");

            });

            swipeTouched = false;
        }).on('webkitAnimationEnd', function () {
            swipeMoving = false;

        });

    }

    //分享代码 开发用
    function onBridgeReady() {
        //朋友圈
        WeixinJSBridge.on("menu:share:timeline", function (e) {
            var data = {
                img_url : g_shareData.image_url,
                img_width : "80",
                img_height : "80",
                link : g_shareData.share_url,
                desc : g_shareData.desc,
                title : g_shareData.title
            };
            WeixinJSBridge.invoke("shareTimeline", data, function (res) {
                WeixinJSBridge.log(res.err_msg);
            });
        });
        //微博
        WeixinJSBridge.on("menu:share:weibo", function () {
            WeixinJSBridge.invoke("shareWeibo", {
                "content" : g_shareData.title + ' - ' + g_shareData.desc,
                "url" : g_shareData.share_url
            }, function (res) {
                WeixinJSBridge.log(res.err_msg);
            });
        });
        //朋友
        WeixinJSBridge.on('menu:share:appmessage', function (argv) {
            var data = {
                img_url : g_shareData.image_url,
                img_width : "80",
                img_height : "80",
                link : g_shareData.share_url + '?ADTAG=weixin',
                desc : g_shareData.desc,
                title : g_shareData.title
            };

            WeixinJSBridge.invoke("sendAppMessage", data, function (res) {
                WeixinJSBridge.log(res.err_msg);
            });
        });

    }

    ;(function () {
        addEvtHandler();
        setTimeout(function () {
            //window.scrollTo(0, 1);
            //添加动画触发类
            $(".item-0").addClass("play");

        }, 0);

        //输出错误信息
        window.onerror = function (e, url, line) {
            //alert(e + '\n' + url + '\n' + line);
        };

        //页面首次载入动作
        $(document).one('touchstart', function () {
            //$('#h5audio')[0].play();
        });

        ///微信分享代码  开发用
         document.addEventListener('WeixinJSBridgeReady', function () {
         // onBridgeReady();
         });


    })();

})(Zepto);

////!!!以下代码务必要引入 否则会导致页面无法正常滚动
document.addEventListener('touchmove', function (evt) {
    evt.preventDefault();
});
</script>


</body>
</html>